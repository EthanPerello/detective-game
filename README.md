# 🕵️ Detective Game - Dojo Game Jam Submission

A fully on-chain murder mystery game built with the Dojo Engine where players interrogate AI-powered suspects to solve "The Office Party Murder." Features dynamic conversations generated by OpenAI GPT-4o-mini, smart contract game state management, and a hybrid blockchain architecture.

**🏆 Built for [Dojo Game Jam #6](https://github.com/dojoengine/game-jam-6) - Full Game Track**

## 🎮 Game Features

### Core Gameplay
- **🤖 AI-Powered Conversations**: Each suspect has unique personality traits and secrets revealed through OpenAI-generated dialogue
- **🎯 One-Shot Investigation**: Players get only ONE accusation attempt - choose wisely!
- **📊 Global Rankings**: Track completion statistics and player rankings across all games
- **⛓️ Blockchain Integration**: All game actions recorded on Starknet via Dojo smart contracts

### Current Case: "The Office Party Murder"
- **Victim**: Marcus Thompson (Company CEO)
- **Suspects**: Sarah (Assistant), David (IT Manager), Janet (HR Director)
- **Setting**: Corporate office after holiday party
- **Weapon**: Letter opener from victim's desk

## 🏗️ Technical Architecture

### Blockchain Layer (Dojo + Starknet)
- **Smart Contracts**: Complete Cairo implementation with game state management
- **World Address**: `0x0598cc6424eb59171928b1f7da3144c33a80ebe8f1f5c2e67ad9731b1e32e7f4`
- **Deployed on**: Cartridge Slot (Sepolia-compatible)
- **Models**: Game, Player, Accusation with full ECS architecture
- **Systems**: `start_game()`, `make_accusation()` with validation logic

### Frontend (React + TypeScript)
- **Framework**: React 18 + Vite + TypeScript
- **Styling**: Tailwind CSS with custom detective theme
- **State Management**: React hooks + Dojo provider integration
- **Real-time Features**: AI chat interface with typing indicators

### Backend (Node.js API)
- **AI Integration**: OpenAI GPT-4o-mini for character dialogue
- **Character System**: Graduated secret disclosure based on conversation flow
- **Statistics**: In-memory tracking with blockchain fallback
- **CORS**: Configured for frontend integration

### Hybrid Architecture
The game intelligently switches between blockchain-first and API fallback modes:
```typescript
// Blockchain-first approach with graceful fallback
if (dojoProvider && katanaConnected) {
  try {
    const gameId = await dojoProvider.actions.start_game();
  } catch (error) {
    const response = await axios.post('/api/game/start');
  }
}
```

## 🚀 Quick Start

### Prerequisites
- Node.js 18+
- Git
- OpenAI API Key

### Local Development Setup

**1. Clone and Install**
```bash
git clone https://github.com/EthanPerello/detective-game.git
cd detective-game

# Install dependencies
npm install
cd frontend && npm install
cd ../backend && npm install
```

**2. Environment Setup**
```bash
# In backend/.env
OPENAI_API_KEY=your_openai_api_key_here
PORT=3001
```

**3. Start All Services**
```bash
# Terminal 1 - Backend API
cd backend
npm start

# Terminal 2 - Frontend
cd frontend  
npm run dev

# Terminal 3 - Blockchain (Optional - already deployed to Slot)
# katana --dev --dev.no-fee
# sozo build && sozo migrate
# torii --world <WORLD_ADDRESS> --http.cors_origins "*"
```

**4. Play the Game**
- Open `http://localhost:5173`
- Select "The Office Party Murder" case
- Question the three suspects
- Make your accusation and solve the mystery!

## 🌐 Live Deployment

- **Contracts**: Deployed on Cartridge Slot
- **Frontend**: Coming soon to Vercel
- **Backend**: Local development (see setup above)

## 📂 Project Structure

```
detective-game/
├── src/                    # Cairo smart contracts (Dojo)
│   ├── models.cairo       # Game state models
│   ├── systems/           # Game logic systems
│   └── tests/             # Contract tests
├── frontend/              # React application
│   ├── src/components/    # UI components
│   ├── src/dojo/         # Blockchain integration
│   └── src/generated/    # Auto-generated contract bindings
├── backend/              # Node.js API server
│   ├── server.js         # Express server
│   └── characters.js     # AI character definitions
├── assets/               # Game assets
├── Scarb.toml           # Dojo project configuration
└── dojo_dev.toml        # Deployment configuration
```

## 🎯 Game Jam Highlights

### Novel Dojo Engine Usage
- **Hybrid Architecture**: Seamless fallback between blockchain and API
- **ECS Design**: Clean separation of game state and logic
- **Event System**: On-chain events for player actions and game outcomes
- **Gas Optimization**: Efficient contract calls with minimal state changes

### Technical Innovation
- **AI Integration**: First detective game with AI-powered suspect conversations on Dojo
- **Progressive Disclosure**: Character secrets revealed based on conversation quality
- **One-Shot Mechanics**: High-stakes gameplay with permanent consequences
- **Cross-Platform**: Works in browser with Cartridge Controller integration

## 🔮 Future Features (Post-Jam Roadmap)

### Phase 1: Enhanced Gameplay
- [ ] **Timer System**: Track investigation time and leaderboard rankings
- [ ] **Token Rewards**: NFT badges for completion with time/ranking bonuses
- [ ] **Character Relationships**: Like/dislike system affecting conversation flow
- [ ] **Clue System**: "Important clues" indicators and progress tracking
- [ ] **Loading States**: Better UX for blockchain transaction feedback

### Phase 2: Content Expansion  
- [ ] **Multiple Cases**: "The Locked Library", "The Vanishing Heir", "The Digital Heist"
- [ ] **AI Case Generation**: Procedurally generated mysteries using GPT-4
- [ ] **Deeper Lore**: Extended character backstories and case descriptions
- [ ] **Evidence Collection**: Physical evidence system beyond conversations

### Phase 3: Multiplayer Features
- [ ] **Collaborative Investigation**: Multiple detectives, each assigned a suspect
- [ ] **Deliberation Rooms**: Timed discussion phases between questioning
- [ ] **Competitive Modes**: Speed solving and accuracy competitions
- [ ] **Custom Cases**: Community-created mysteries

### Phase 4: Platform & Polish
- [ ] **Mobile Optimization**: Responsive design for all devices
- [ ] **Wallet Integration**: Full Cartridge Controller implementation
- [ ] **Progressive Web App**: Offline capability and app-like experience
- [ ] **Analytics Dashboard**: Player statistics and game metrics

## 🏆 Awards & Recognition

- **Dojo Game Jam #6 Submission** - Full Game Track
- **OnlyDust Registered** - Eligible for contributor rewards

## 🛠️ Known Limitations (Time Constraints)

- **Blockchain Integration**: Currently hybrid mode (blockchain + API fallback)
- **Mobile Responsiveness**: Optimized for desktop, mobile needs refinement
- **Loading States**: Missing transaction progress indicators
- **Single Case**: Only one mystery available (more planned)
- **Local Backend**: API server requires local setup

## 🧰 Tech Stack

| Layer | Technology |
|-------|------------|
| **Blockchain** | Cairo, Dojo, Starknet, Cartridge Slot |
| **Frontend** | React 18, TypeScript, Vite, Tailwind CSS |
| **Backend** | Node.js, Express, OpenAI GPT-4o-mini |
| **Deployment** | Vercel (Frontend), Slot (Contracts) |
| **Development** | Git, npm, Scarb, Sozo, Katana, Torii |

## 🎖️ Created By

**Ethan Perello**
- 🌐 Portfolio: [ethanperello.github.io](https://ethanperello.github.io/)
- 💼 LinkedIn: [linkedin.com/in/EthanPerello](http://linkedin.com/in/EthanPerello)
- 💻 GitHub: [github.com/EthanPerello](https://github.com/EthanPerello)
- 🐦 Twitter: [@ethanperello](https://twitter.com/ethanperello)

## 📜 License

This project is open source and available under the [MIT License](./LICENSE).

---

*Built with ❤️ for the Dojo Game Jam. Solve mysteries, question suspects, and prove your detective skills on the blockchain!* 🕵️‍♂️